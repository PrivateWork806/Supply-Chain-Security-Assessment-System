<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Supply Chain Security Assessment System</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background: #ecf0f3;
      height: 100vh;
      display: flex;
    }
    /* Sidebar */
    #sidebar {
      width: 220px;
      background: #2c3e50;
      color: white;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      display: none; /* hidden until login */
    }
    #sidebar h2 { font-size: 18px; margin-bottom: 15px; }
    #sidebar button {
      background: #34495e;
      border: none;
      padding: 10px;
      color: white;
      border-radius: 6px;
      text-align: left;
      cursor: pointer;
      transition: background 0.3s;
    }
    #sidebar button:hover { background: #1abc9c; }

    /* Main content */
    #main {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      display: none; /* hidden until login */
    }
    h3 { margin-top: 0; }
    .card {
      background: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    pre {
      background: #f4f4f4;
      padding: 10px;
      border-radius: 6px;
      overflow-x: auto;
    }
    .status-open { color: red; font-weight: bold; }
    .status-resolved { color: green; font-weight: bold; }
    .risk-high { color: red; font-weight: bold; }
    .risk-medium { color: orange; font-weight: bold; }
    .risk-low { color: green; font-weight: bold; }

    /* Login screen */
    #loginScreen {
      margin: auto;
      text-align: center;
    }
    #loginScreen input {
      display: block;
      margin: 10px auto;
      padding: 10px;
      width: 250px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    #loginScreen button {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      background: #3498db;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }
    #loginScreen button:hover { background: #2980b9; }
  </style>
</head>
<body>
  <!-- Login Screen -->
  <div id="loginScreen">
    <h2>üîê SCSA Login</h2>
    <input type="email" id="email" placeholder="Email" value="admin.scsa@gmail.com">
    <input type="password" id="password" placeholder="Password" value="password">
    <button onclick="doLogin()">Login</button>
  </div>

  <!-- Sidebar -->
  <div id="sidebar">
    <h2>üìä SCSA System</h2>
    <button onclick="viewSuppliers()">üìã View Suppliers</button>
    <button onclick="addSupplier()">‚ûï Add Supplier</button>
    <button onclick="viewAssessments()">üìä View Assessments</button>
    <button onclick="runAssessment()">‚ö° Run Assessment</button>
    <button onclick="viewIncidents()">‚ö†Ô∏è View Incidents</button>
    <button onclick="addIncident()">‚ûï Log Incident</button>
    <button onclick="viewAudit()">üïë Audit Log</button>
  </div>

  <!-- Main -->
  <div id="main">
    <div class="card">
      <h3>Welcome</h3>
      <p id="welcome">Please log in to continue...</p>
    </div>
    <div class="card">
      <h3>Output</h3>
      <div id="output">Nothing yet.</div>
    </div>
  </div>

  <script>
    // Data
    let suppliers = [
      {id:1, name:"Alpha Logistics", industry:"Transport", contact_email:"alpha.logistics@gmail.com", risk_tier:"Medium"},
      {id:2, name:"Global Foods Ltd", industry:"Retail", contact_email:"globalfoods@gmail.com", risk_tier:"Low"},
      {id:3, name:"TechSource IT", industry:"Technology", contact_email:"techsourceit@gmail.com", risk_tier:"High"},
      {id:4, name:"PharmaHealth Supplies", industry:"Healthcare", contact_email:"pharmahealthsupplies@gmail.com", risk_tier:"Medium"},
      {id:5, name:"AgriFresh Produce", industry:"Agriculture", contact_email:"agrifreshproduce@gmail.com", risk_tier:"Low"}
    ];
    let assessments = [
      {supplier_id:1, risk_score:65, by:"assessor.scsa@gmail.com", date:"2025-09-01"},
      {supplier_id:3, risk_score:82, by:"assessor.scsa@gmail.com", date:"2025-09-10"},
      {supplier_id:4, risk_score:48, by:"assessor.scsa@gmail.com", date:"2025-09-20"}
    ];
    let incidents = [
      {id:1, supplier_id:1, description:"Truck breakdown delayed delivery", severity:"Medium", status:"Resolved"},
      {id:2, supplier_id:3, description:"Cybersecurity breach in supplier system", severity:"High", status:"Open"},
      {id:3, supplier_id:2, description:"Late supply of goods during holiday", severity:"Low", status:"Resolved"}
    ];
    let audit = [
      {user:"admin.scsa@gmail.com", action:"CREATE_SUPPLIER", time:"09:00", details:"Added Alpha Logistics"},
      {user:"assessor.scsa@gmail.com", action:"RUN_ASSESSMENT", time:"10:00", details:"Supplier 1 Score 65"},
      {user:"assessor.scsa@gmail.com", action:"RUN_ASSESSMENT", time:"10:20", details:"Supplier 3 Score 82"},
      {user:"admin.scsa@gmail.com", action:"CREATE_INCIDENT", time:"11:20", details:"Cybersecurity breach in supplier system"}
    ];
    const users = [
      {email:"admin.scsa@gmail.com", password:"password", role:"Admin"},
      {email:"assessor.scsa@gmail.com", password:"password", role:"Assessor"},
      {email:"auditor.scsa@gmail.com", password:"password", role:"Auditor"}
    ];
    let currentUser = null;

    function logAction(action, details="") {
      audit.unshift({user: currentUser.email, action, time:new Date().toLocaleTimeString(), details});
    }

    function doLogin() {
      const email = document.getElementById("email").value;
      const pw = document.getElementById("password").value;
      const u = users.find(x=>x.email===email && x.password===pw);
      if(u){
        currentUser=u;
        logAction("LOGIN");
        document.getElementById("loginScreen").style.display="none";
        document.getElementById("sidebar").style.display="flex";
        document.getElementById("main").style.display="block";
        document.getElementById("welcome").innerText="‚úÖ Logged in as "+u.role;
      } else {
        alert("Invalid login. Try admin.scsa@gmail.com / password");
      }
    }

    function addSupplier() {
      const name=prompt("Supplier name");
      const ind=prompt("Industry");
      const mail=prompt("Email");
      const id = suppliers.length+1;
      suppliers.push({id,name,industry:ind,contact_email:mail,risk_tier:"Medium"});
      logAction("CREATE_SUPPLIER",name);
      show("Supplier added: "+name);
    }

    function viewSuppliers() {
      let html = "<h4>Suppliers</h4><ul>";
      suppliers.forEach(s=>{
        html += `<li><b>${s.name}</b> (${s.industry}) - Contact: ${s.contact_email} | Tier: <span class="risk-${s.risk_tier.toLowerCase()}">${s.risk_tier}</span></li>`;
      });
      html += "</ul>";
      show(html);
    }

    function runAssessment() {
      const sid=prompt("Supplier ID");
      const supplier = suppliers.find(s=>s.id==sid);
      if(!supplier){ alert("No such supplier"); return; }
      let score = 10 + Math.floor(Math.random()*70);
      assessments.push({supplier_id:sid, risk_score:score, by:currentUser.email, date:new Date().toLocaleDateString()});
      logAction("RUN_ASSESSMENT","Supplier "+sid+" Score "+score);
      show(`Risk score for <b>${supplier.name}</b>: <span class="risk-${score>70?"high":score>40?"medium":"low"}">${score}</span>`);
    }

    function viewAssessments(){
      let html="<h4>Assessments</h4><ul>";
      assessments.forEach(a=>{
        const sup = suppliers.find(s=>s.id==a.supplier_id);
        let riskClass=a.risk_score>70?"high":a.risk_score>40?"medium":"low";
        html += `<li>${sup? sup.name:"Unknown"} - Score: <span class="risk-${riskClass}">${a.risk_score}</span> (by ${a.by} on ${a.date})</li>`;
      });
      html+="</ul>";
      show(html);
    }

    function addIncident(){
      const sid=prompt("Supplier ID");
      const desc=prompt("Description");
      const sev=prompt("Severity (High/Medium/Low)");
      const supplier = suppliers.find(s=>s.id==sid);
      incidents.push({id:incidents.length+1,supplier_id:sid,description:desc,severity:sev,status:"Open"});
      logAction("CREATE_INCIDENT",desc);
      show(`Incident logged for <b>${supplier? supplier.name:"Supplier "+sid}</b>: ${desc} (Severity: ${sev})`);
    }

    function viewIncidents(){
      let html="<h4>Incidents</h4><ul>";
      incidents.forEach(i=>{
        const sup = suppliers.find(s=>s.id==i.supplier_id);
        html += `<li>${sup? sup.name:"Unknown"}: ${i.description} | Severity: ${i.severity} | Status: <span class="status-${i.status.toLowerCase()}">${i.status}</span></li>`;
      });
      html+="</ul>";
      show(html);
    }

    function viewAudit(){
      let html="<h4>Audit Log</h4><pre>";
      audit.forEach(a=>{
        html += `[${a.time}] ${a.user} ‚Üí ${a.action} (${a.details})\n`;
      });
      html+="</pre>";
      show(html);
    }

    function show(html){ document.getElementById("output").innerHTML=html; }
  </script>
</body>
</html>
